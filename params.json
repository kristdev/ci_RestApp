{"name":"Ci restapp","tagline":"Amazing Codeigniter Restfull application","body":"\r\n\r\n----------\r\n\r\n1. [Read me](./readme.md \"Read me\") | 2. Data analysyis | 3. [Data generating ](./datagenerating.md \"Data generating\") | 4. [Le serveur Rest](./leserveurrest.md \"Le serveur Rest\")\r\n\r\n----------\r\n\r\n## Data Analysis ##\r\n\r\nD'après une étude de fonctionalités, bien que notre base de données ne contient pas du big data, nous allons tout de même optimiser notre base de données pour les requêtes de lecture, en créant des pseudo vues matérialisées.\r\n\r\nNous voulons de façon précise,\r\n\r\n1. La liste de tous les articles écrits, avec les données utilisateurs\r\n2. La liste de tous les commentaires écrits, les données de l'article reférent et utilisateurs.\r\n\r\nCes exigences nous imposent un modèle avec des vues, triggers et vues matérialisées que voici:\r\n\r\n![](./ci_restapp.png)\r\n\r\n### Mysql workbench data generating ###\r\n    -- MySQL Script generated by MySQL Workbench\r\n    -- 12/10/14 07:06:47\r\n    -- Model: New ModelVersion: 1.0\r\n    -- MySQL Workbench Forward Engineering\r\n    \r\n    SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;\r\n    SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;\r\n    SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';\r\n    \r\n    -- -----------------------------------------------------\r\n    -- Schema ci_restapp\r\n    -- -----------------------------------------------------\r\n    \r\n    -- -----------------------------------------------------\r\n    -- Schema ci_restapp\r\n    -- -----------------------------------------------------\r\n    CREATE SCHEMA IF NOT EXISTS `ci_restapp` DEFAULT CHARACTER SET latin1 ;\r\n    USE `ci_restapp` ;\r\n    \r\n    -- -----------------------------------------------------\r\n    -- Table `ci_restapp`.`utilisateur`\r\n    -- -----------------------------------------------------\r\n    DROP TABLE IF EXISTS `ci_restapp`.`utilisateur` ;\r\n    \r\n    CREATE TABLE IF NOT EXISTS `ci_restapp`.`utilisateur` (\r\n      `id` INT NOT NULL AUTO_INCREMENT,\r\n      `name` VARCHAR(120) NOT NULL,\r\n      `username` VARCHAR(25) NOT NULL,\r\n      `avatar` VARCHAR(255) NULL,\r\n      `email` VARCHAR(55) NULL,\r\n      `password` VARCHAR(255) NULL,\r\n      PRIMARY KEY (`id`))\r\n    ENGINE = InnoDB;\r\n    \r\n    CREATE UNIQUE INDEX `username_UNIQUE` ON `ci_restapp`.`utilisateur` (`username` ASC);\r\n    \r\n    CREATE UNIQUE INDEX `email_UNIQUE` ON `ci_restapp`.`utilisateur` (`email` ASC);\r\n    \r\n    \r\n    -- -----------------------------------------------------\r\n    -- Table `ci_restapp`.`article`\r\n    -- -----------------------------------------------------\r\n    DROP TABLE IF EXISTS `ci_restapp`.`article` ;\r\n    \r\n    CREATE TABLE IF NOT EXISTS `ci_restapp`.`article` (\r\n      `id` INT NOT NULL AUTO_INCREMENT,\r\n      `title` VARCHAR(120) NOT NULL,\r\n      `content` LONGTEXT NULL,\r\n      `utilisateur_id` INT NOT NULL,\r\n      PRIMARY KEY (`id`),\r\n      CONSTRAINT `fk_article_utilisateur1`\r\n    FOREIGN KEY (`utilisateur_id`)\r\n    REFERENCES `ci_restapp`.`utilisateur` (`id`)\r\n    ON DELETE CASCADE\r\n    ON UPDATE CASCADE)\r\n    ENGINE = InnoDB;\r\n    \r\n    CREATE INDEX `fk_article_utilisateur1_idx` ON `ci_restapp`.`article` (`utilisateur_id` ASC);\r\n    \r\n    \r\n    -- -----------------------------------------------------\r\n    -- Table `ci_restapp`.`commentaire`\r\n    -- -----------------------------------------------------\r\n    DROP TABLE IF EXISTS `ci_restapp`.`commentaire` ;\r\n    \r\n    CREATE TABLE IF NOT EXISTS `ci_restapp`.`commentaire` (\r\n      `id` INT NOT NULL AUTO_INCREMENT,\r\n      `content` VARCHAR(180) NOT NULL,\r\n      `utilisateur_id` INT NOT NULL,\r\n      `article_id` INT NOT NULL,\r\n      PRIMARY KEY (`id`),\r\n      CONSTRAINT `fk_commentaire_utilisateur`\r\n    FOREIGN KEY (`utilisateur_id`)\r\n    REFERENCES `ci_restapp`.`utilisateur` (`id`)\r\n    ON DELETE CASCADE\r\n    ON UPDATE CASCADE,\r\n      CONSTRAINT `fk_commentaire_article1`\r\n    FOREIGN KEY (`article_id`)\r\n    REFERENCES `ci_restapp`.`article` (`id`)\r\n    ON DELETE CASCADE\r\n    ON UPDATE CASCADE)\r\n    ENGINE = InnoDB;\r\n    \r\n    CREATE INDEX `fk_commentaire_utilisateur_idx` ON `ci_restapp`.`commentaire` (`utilisateur_id` ASC);\r\n    \r\n    CREATE INDEX `fk_commentaire_article1_idx` ON `ci_restapp`.`commentaire` (`article_id` ASC);\r\n    \r\n    \r\n    -- -----------------------------------------------------\r\n    -- Table `ci_restapp`.`vm_commentaire`\r\n    -- -----------------------------------------------------\r\n    DROP TABLE IF EXISTS `ci_restapp`.`vm_commentaire` ;\r\n    \r\n    CREATE TABLE IF NOT EXISTS `ci_restapp`.`vm_commentaire` (\r\n      `commentaire_id` INT(11) NOT NULL DEFAULT '0',\r\n      `commentaire` VARCHAR(180) NOT NULL,\r\n      `utilisateur_id` INT(11) NOT NULL DEFAULT '0',\r\n      `name` VARCHAR(120) NOT NULL,\r\n      `username` VARCHAR(25) NOT NULL,\r\n      `avatar` VARCHAR(255) NULL DEFAULT NULL,\r\n      `email` VARCHAR(55) NULL DEFAULT NULL,\r\n      `article_id` INT(11) NOT NULL DEFAULT '0',\r\n      `title` VARCHAR(120) NOT NULL,\r\n      `article` LONGTEXT NULL DEFAULT NULL)\r\n    ENGINE = InnoDB\r\n    DEFAULT CHARACTER SET = latin1;\r\n    \r\n    CREATE INDEX `index2` ON `ci_restapp`.`vm_commentaire` (`utilisateur_id` ASC);\r\n    \r\n    CREATE INDEX `index3` ON `ci_restapp`.`vm_commentaire` (`article_id` ASC);\r\n    \r\n    CREATE INDEX `index4` ON `ci_restapp`.`vm_commentaire` (`name` ASC);\r\n    \r\n    CREATE INDEX `index5` ON `ci_restapp`.`vm_commentaire` (`username` ASC);\r\n    \r\n    CREATE INDEX `index6` ON `ci_restapp`.`vm_commentaire` (`email` ASC);\r\n    \r\n    CREATE INDEX `index7` ON `ci_restapp`.`vm_commentaire` (`title` ASC);\r\n    \r\n    CREATE INDEX `index1` ON `ci_restapp`.`vm_commentaire` (`commentaire_id` ASC);\r\n    \r\n    \r\n    -- -----------------------------------------------------\r\n    -- Table `ci_restapp`.`vm_article`\r\n    -- -----------------------------------------------------\r\n    DROP TABLE IF EXISTS `ci_restapp`.`vm_article` ;\r\n    \r\n    CREATE TABLE IF NOT EXISTS `ci_restapp`.`vm_article` (\r\n      `article_id` INT(11) NOT NULL DEFAULT '0',\r\n      `title` VARCHAR(120) NOT NULL,\r\n      `article` LONGTEXT NULL DEFAULT NULL,\r\n      `utilisateur_id` INT(11) NOT NULL DEFAULT '0',\r\n      `name` VARCHAR(120) NOT NULL,\r\n      `username` VARCHAR(25) NOT NULL,\r\n      `avatar` VARCHAR(255) NULL DEFAULT NULL,\r\n      `email` VARCHAR(55) NULL DEFAULT NULL)\r\n    ENGINE = InnoDB\r\n    DEFAULT CHARACTER SET = latin1;\r\n    \r\n    CREATE INDEX `index2` ON `ci_restapp`.`vm_article` (`title` ASC);\r\n    \r\n    CREATE INDEX `index3` ON `ci_restapp`.`vm_article` (`utilisateur_id` ASC);\r\n    \r\n    CREATE INDEX `index4` ON `ci_restapp`.`vm_article` (`name` ASC);\r\n    \r\n    CREATE INDEX `index5` ON `ci_restapp`.`vm_article` (`username` ASC);\r\n    \r\n    CREATE INDEX `index6` ON `ci_restapp`.`vm_article` (`email` ASC);\r\n    \r\n    CREATE INDEX `index1` ON `ci_restapp`.`vm_article` (`article_id` ASC);\r\n    \r\n    USE `ci_restapp` ;\r\n    \r\n    -- -----------------------------------------------------\r\n    -- View `ci_restapp`.`v_commentaire`\r\n    -- -----------------------------------------------------\r\n    DROP VIEW IF EXISTS `ci_restapp`.`v_commentaire` ;\r\n    USE `ci_restapp`;\r\n    CREATE  OR REPLACE VIEW `v_commentaire` AS\r\n    select commentaire.id as commentaire_id, commentaire.content as commentaire, utilisateur.id as utilisateur_id, utilisateur.name, utilisateur.username, utilisateur.avatar, utilisateur.email, article.id as article_id, article.title, article.content as article from commentaire inner join utilisateur on commentaire.utilisateur_id=utilisateur.id inner join article on commentaire.article_id=article.utilisateur_id;\r\n    \r\n    -- -----------------------------------------------------\r\n    -- View `ci_restapp`.`v_article`\r\n    -- -----------------------------------------------------\r\n    DROP VIEW IF EXISTS `ci_restapp`.`v_article` ;\r\n    USE `ci_restapp`;\r\n    CREATE  OR REPLACE VIEW `v_article` AS\r\n    select article.id as article_id, article.title, article.content as article, utilisateur.id as utilisateur_id, utilisateur.name, utilisateur.username, utilisateur.avatar, utilisateur.email from article inner join utilisateur on article.utilisateur_id=utilisateur.id;\r\n    USE `ci_restapp`;\r\n    \r\n    DELIMITER $$\r\n    \r\n    USE `ci_restapp`$$\r\n    DROP TRIGGER IF EXISTS `ci_restapp`.`article_AFTER_INSERT` $$\r\n    USE `ci_restapp`$$\r\n    CREATE DEFINER = CURRENT_USER TRIGGER `ci_restapp`.`article_AFTER_INSERT` AFTER INSERT ON `article` FOR EACH ROW\r\n       begin\r\n       insert into vm_article select * from v_article where article_id=new.id;\r\n       end$$\r\n    \r\n    \r\n    USE `ci_restapp`$$\r\n    DROP TRIGGER IF EXISTS `ci_restapp`.`article_AFTER_UPDATE` $$\r\n    USE `ci_restapp`$$\r\n    CREATE DEFINER = CURRENT_USER TRIGGER `ci_restapp`.`article_AFTER_UPDATE` AFTER UPDATE ON `article` FOR EACH ROW\r\n    begin\r\n    update vm_article set title=new.title and article=new.content where article_id=old.id;\r\n    end$$\r\n    \r\n    \r\n    USE `ci_restapp`$$\r\n    DROP TRIGGER IF EXISTS `ci_restapp`.`article_AFTER_DELETE` $$\r\n    USE `ci_restapp`$$\r\n    CREATE DEFINER = CURRENT_USER TRIGGER `ci_restapp`.`article_AFTER_DELETE` AFTER DELETE ON `article` FOR EACH ROW\r\n    BEGIN\r\n    \tdelete from vm_article where article_id=old.id;\r\n    \tEND$$\r\n    \r\n    \r\n    USE `ci_restapp`$$\r\n    DROP TRIGGER IF EXISTS `ci_restapp`.`commentaire_AFTER_INSERT` $$\r\n    USE `ci_restapp`$$\r\n    CREATE DEFINER = CURRENT_USER TRIGGER `ci_restapp`.`commentaire_AFTER_INSERT` AFTER INSERT ON `commentaire` FOR EACH ROW\r\n    begin\r\n    insert into vm_commentaire select * from v_commentaire where commentaire_id=new.id;\r\n    end$$\r\n    \r\n    \r\n    USE `ci_restapp`$$\r\n    DROP TRIGGER IF EXISTS `ci_restapp`.`commentaire_AFTER_DELETE` $$\r\n    USE `ci_restapp`$$\r\n    CREATE DEFINER = CURRENT_USER TRIGGER `ci_restapp`.`commentaire_AFTER_DELETE` AFTER DELETE ON `commentaire` FOR EACH ROW\r\n     begin\r\n     delete from vm_commentaire where commentaire_id=old.id;\r\n     end$$\r\n    \r\n    \r\n    DELIMITER ;\r\n    \r\n    SET SQL_MODE=@OLD_SQL_MODE;\r\n    SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;\r\n    SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;\r\n    \r\n----------\r\n\r\n1. [Read me](./readme.md \"Read me\") | 2. Data analysyis | 3. [Data generating ](./datagenerating.md \"Data generating\") | 4. [Le serveur Rest](./leserveurrest.md \"Le serveur Rest\")\r\n\r\n----------\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}